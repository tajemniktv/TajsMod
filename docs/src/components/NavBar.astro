---
import ThemeToggle from "./ThemeToggle.astro";

const navItems = [
  { name: "Home", href: `${import.meta.env.BASE_URL}/` },
  { name: "Features", href: `${import.meta.env.BASE_URL}/features/` },
  { name: "Docs", href: `${import.meta.env.BASE_URL}/docs/` },
  { name: "FAQ", href: `${import.meta.env.BASE_URL}/faq/` },
  { name: "Changelog", href: `${import.meta.env.BASE_URL}/changelog/` },
  { name: "Screenshots", href: `${import.meta.env.BASE_URL}/screenshots/` },
  { name: "Roadmap", href: `${import.meta.env.BASE_URL}/roadmap/` },
  { name: "Support", href: `${import.meta.env.BASE_URL}/support/` },
];

const currentPath = Astro.url.pathname;
---

<header class="fixed top-0 left-0 right-0 z-50 glass">
  <nav class="container-wide">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a
        href={`${import.meta.env.BASE_URL}/`}
        class="flex items-center gap-3 group"
      >
        <img
          src={`${import.meta.env.BASE_URL}/brand/TajsModLogo.png`}
          alt="Taj's Mod Logo"
          class="h-10 w-10 rounded-lg shadow-sm group-hover:shadow-md transition-shadow"
        />
        <span class="font-bold text-xl hidden sm:block">Taj's Mod</span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center gap-1">
        {
          navItems.map((item) => {
            const isActive =
              currentPath === item.href ||
              (item.href !== `${import.meta.env.BASE_URL}/` &&
                currentPath.startsWith(item.href));
            return (
              <a
                href={item.href}
                class:list={[
                  "px-4 py-2 rounded-lg text-sm font-medium transition-colors",
                  isActive
                    ? "bg-accent-500/10 text-accent-600 dark:text-accent-400"
                    : "text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-dark-800",
                ]}
              >
                {item.name}
              </a>
            );
          })
        }
      </div>

      <!-- Right Side Actions -->
      <div class="flex items-center gap-3">
        <ThemeToggle />

        <a
          href="https://steamcommunity.com/sharedfiles/filedetails/?id=3628222709"
          target="_blank"
          rel="noopener noreferrer"
          class="btn-primary text-sm hidden sm:inline-flex"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M12 2C6.48 2 2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95 0-5.52-4.48-10-10-10z"
            ></path>
          </svg>
          Subscribe
        </a>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-btn"
          class="lg:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-800 transition-colors"
          aria-label="Toggle menu"
          aria-expanded="false"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="hidden lg:hidden pb-4">
      <div
        class="flex flex-col gap-1 pt-4 border-t border-gray-200 dark:border-dark-700"
      >
        {
          navItems.map((item) => {
            const isActive =
              currentPath === item.href ||
              (item.href !== `${import.meta.env.BASE_URL}/` &&
                currentPath.startsWith(item.href));
            return (
              <a
                href={item.href}
                class:list={[
                  "px-4 py-3 rounded-lg font-medium transition-colors",
                  isActive
                    ? "bg-accent-500/10 text-accent-600 dark:text-accent-400"
                    : "text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-dark-800",
                ]}
              >
                {item.name}
              </a>
            );
          })
        }
        <a
          href="https://steamcommunity.com/sharedfiles/filedetails/?id=3628222709"
          target="_blank"
          rel="noopener noreferrer"
          class="btn-primary mt-2 justify-center"
        >
          Subscribe on Steam
        </a>
      </div>
    </div>
  </nav>
</header>

<!-- Spacer for fixed header -->
<div class="h-16"></div>

<script>
  function initMobileMenu() {
    const btn = document.getElementById("mobile-menu-btn");
    const menu = document.getElementById("mobile-menu");

    btn?.addEventListener("click", () => {
      const isOpen = menu?.classList.contains("hidden");
      menu?.classList.toggle("hidden", !isOpen);
      btn?.setAttribute("aria-expanded", isOpen ? "true" : "false");
    });
  }

  document.addEventListener("astro:page-load", initMobileMenu);
  initMobileMenu();
</script>
